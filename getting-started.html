
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Getting started &#8212; pyberny 0.3.2 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Algorithm" href="algorithm.html" />
    <link rel="prev" title="berny — Molecular optimizer" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="getting-started">
<h1>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<div class="section" id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h2>
<p>Python 2.7 or &gt;=3.5 with Numpy</p>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>The Python API consists of coroutine <a class="reference internal" href="api.html#berny.Berny" title="berny.Berny"><code class="xref py py-func docutils literal notranslate"><span class="pre">Berny()</span></code></a> and function
<a class="reference internal" href="api.html#berny.optimize" title="berny.optimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">optimize()</span></code></a>,:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">berny</span> <span class="k">import</span> <span class="n">Berny</span><span class="p">,</span> <span class="n">geomlib</span>
<span class="kn">from</span> <span class="nn">berny.solvers</span> <span class="k">import</span> <span class="n">MopacSolver</span>

<span class="n">optimizer</span> <span class="o">=</span> <span class="n">Berny</span><span class="p">(</span><span class="n">geomlib</span><span class="o">.</span><span class="n">readfile</span><span class="p">(</span><span class="s1">&#39;start.xyz&#39;</span><span class="p">),</span> <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">MopacSolver</span><span class="p">()</span>
<span class="k">for</span> <span class="n">geom</span> <span class="ow">in</span> <span class="n">optimizer</span><span class="p">:</span>
    <span class="n">energy</span><span class="p">,</span> <span class="n">gradients</span> <span class="o">=</span> <span class="n">solver</span><span class="p">(</span><span class="n">geom</span><span class="p">)</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">send</span><span class="p">((</span><span class="n">energy</span><span class="p">,</span> <span class="n">gradients</span><span class="p">))</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">berny</span> <span class="k">import</span> <span class="n">optimize</span><span class="p">,</span> <span class="n">geomlib</span>
<span class="kn">from</span> <span class="nn">berny.solvers</span> <span class="k">import</span> <span class="n">MopacSolver</span>

<span class="n">relaxed</span> <span class="o">=</span> <span class="n">optimize</span><span class="p">(</span><span class="n">MopacSolver</span><span class="p">(),</span> <span class="n">geomlib</span><span class="o">.</span><span class="n">readfile</span><span class="p">(</span><span class="s1">&#39;start.xyz&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>A different option is to use the package via a command-line or socket
interface defined in <code class="docutils literal notranslate"><span class="pre">berny</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">berny</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">init</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">f</span> <span class="p">{</span><span class="n">xyz</span><span class="p">,</span><span class="n">aims</span><span class="p">}]</span> <span class="p">[</span><span class="o">-</span><span class="n">s</span> <span class="n">host</span> <span class="n">port</span><span class="p">]</span> <span class="p">[</span><span class="n">paramfile</span><span class="p">]</span>

<span class="n">positional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="n">paramfile</span>             <span class="n">Optional</span> <span class="n">optimization</span> <span class="n">parameters</span> <span class="k">as</span> <span class="n">JSON</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>            <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
  <span class="o">--</span><span class="n">init</span>                <span class="n">Initialize</span> <span class="n">Berny</span> <span class="n">optimizer</span><span class="o">.</span>
  <span class="o">-</span><span class="n">f</span> <span class="p">{</span><span class="n">xyz</span><span class="p">,</span><span class="n">aims</span><span class="p">},</span> <span class="o">--</span><span class="nb">format</span> <span class="p">{</span><span class="n">xyz</span><span class="p">,</span><span class="n">aims</span><span class="p">}</span>
                        <span class="n">Format</span> <span class="n">of</span> <span class="n">geometry</span>
  <span class="o">-</span><span class="n">s</span> <span class="n">host</span> <span class="n">port</span><span class="p">,</span> <span class="o">--</span><span class="n">socket</span> <span class="n">host</span> <span class="n">port</span>
                        <span class="n">Listen</span> <span class="n">on</span> <span class="n">given</span> <span class="n">address</span>
</pre></div>
</div>
<p>A call with <code class="docutils literal notranslate"><span class="pre">--init</span></code> corresponds to initializing the <code class="docutils literal notranslate"><span class="pre">Berny</span></code> object
where the geometry is taken from standard input, asssuming format
<code class="docutils literal notranslate"><span class="pre">--format</span></code>. The object is then pickled to <code class="docutils literal notranslate"><span class="pre">berny.pickle</span></code> and the
program quits. Subsequent calls to <code class="docutils literal notranslate"><span class="pre">berny</span></code> recover the <code class="docutils literal notranslate"><span class="pre">Berny</span></code>
object, read energy and gradients from the standard input (first line is
energy, subsequent lines correspond to Cartesian gradients of individual
atoms, all in atomic units) and write the new structure estimate to
standard output. An example usage could look like this:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
./berny --init params.json &lt;start.xyz
cat start.xyz &gt;current.xyz
while true; do
    # calculate energy and gradients of current.xyz
    cat energy_gradients.txt | ./berny &gt;next.xyz
    if [[ $? == 0 ]]; then  # minimum reached
        break
    fi
    mv next.xyz current.xyz
done
</pre></div>
</div>
<p>Alternatively, one can start an optimizer server with the <code class="docutils literal notranslate"><span class="pre">--socket</span></code>
option on a given address and port. This initiates the <code class="docutils literal notranslate"><span class="pre">Berny</span></code> object
and waits for connections, in which it expects to receive energy and
gradients as a request (in the same format as above) and responds with a
new structure estimate in a given format. Example usage would be</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
./berny -s localhost 25000 -f xyz &lt;start.xyz &amp;
cat start.xyz &gt;current.xyz
while true; do
    # calculate energy and gradients of current.xyz
    cat energy_gradients.txt | nc localhost 25000 &gt;next.xyz
    if [[ ! -s next.xyz ]]; then  # minimum reached
        break
    fi
    mv next.xyz current.xyz
done
</pre></div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">pyberny</a></h1>



<p class="blurb">Molecular geometry optimizer</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=azag0&repo=pyberny&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="algorithm.html">Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter"><code class="docutils literal notranslate"><span class="pre">berny</span></code> — Molecular optimizer</a></li>
      <li>Next: <a href="algorithm.html" title="next chapter">Algorithm</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017-2018, Jan Hermann.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
      |
      <a href="_sources/getting-started.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>